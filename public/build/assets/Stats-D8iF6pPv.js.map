{"version":3,"file":"Stats-D8iF6pPv.js","sources":["../../../resources/js/pages/MedicalProduits/Stats.tsx"],"sourcesContent":["import { PageProps } from \"@/types\";\nimport AuthenticatedLayout from \"@/Layouts/AuthenticatedLayout\";\nimport { Head } from \"@inertiajs/react\";\nimport { MedicalProduit, StockMouvement } from \"@/types/models\";\nimport {\n  AreaChart,\n  Area,\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  Legend,\n  ResponsiveContainer,\n} from 'recharts';\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { AlertCircle, AlertTriangle, Box, CarFrontIcon, Eraser } from \"lucide-react\";\n\ninterface Props extends PageProps {\n  produit: MedicalProduit & {\n    mouvements: StockMouvement[];\n    stocks: {\n      total: number;\n      disponible: number;\n      reservee: number;\n      expirer: number;\n      endommage: number;\n    };\n    transferts: {\n      total: number;\n      en_attente: number;\n      preleve: number;\n      livre: number;\n      annule: number;\n    };\n    alerts: {\n      total: number;\n      stock_faible: number;\n      avertissement_expiration: number;\n      expire: number;\n    };\n  };\n}\n\nexport default function MedicamentStats({ auth, produit }: Props) {\n  // Préparer les données pour les graphiques\n  const mouvementsParMois = produit.mouvements.reduce((acc, mouvement) => {\n    const date = new Date(mouvement.created_at);\n    const mois = `${date.getFullYear()}-${(date.getMonth() + 1)\n      .toString()\n      .padStart(2, \"0\")}`;\n\n    if (!acc[mois]) {\n      acc[mois] = { date: mois, entree: 0, sortie: 0, transfert: 0, ajustement: 0 };\n    }\n\n    acc[mois][mouvement.type] += mouvement.quantite;\n\n    return acc;\n  }, {} as Record<string, { date: string; entree: number; sortie: number; transfert: number; ajustement: number }>);\n\n  const mouvementsData = Object.values(mouvementsParMois);\n\n  const stocksData = [\n    { name: \"Disponible\", value: produit.stocks.disponible, fill: \"#10B981\" },\n    { name: \"Réservé\", value: produit.stocks.reservee, fill: \"#FBBF24\" },\n    { name: \"Expiré\", value: produit.stocks.expirer, fill: \"#EF4444\" },\n    { name: \"Endommagé\", value: produit.stocks.endommage, fill: \"#6B7280\" },\n  ];\n\n  const transfertsData = [\n    { name: \"En attente\", value: produit.transferts.en_attente, fill: \"#3B82F6\" },\n    { name: \"Prélevé\", value: produit.transferts.preleve, fill: \"#8B5CF6\" },\n    { name: \"Livré\", value: produit.transferts.livre, fill: \"#10B981\" },\n    { name: \"Annulé\", value: produit.transferts.annule, fill: \"#EF4444\" },\n  ];\n\n  const alertsData = [\n    { name: \"Stock faible\", value: produit.alerts.stock_faible, fill: \"#F97316\" },\n    { name: \"Avertissement\", value: produit.alerts.avertissement_expiration, fill: \"#FBBF24\" },\n    { name: \"Expiré\", value: produit.alerts.expire, fill: \"#EF4444\" },\n    { name: \"Demande Transfert\", value: produit.alerts.demande_transfert, fill: \"#EA44\" },\n    { name: \"Systeme\", value: produit.alerts.systeme, fill: \"#fff\" },\n  ];\n  return (\n    <Card>\n        <CardHeader>\n            <CardTitle className=\"font-semibold text-xl  leading-tight\">\n                Statistiques du médicament: {produit.name}\n            </CardTitle>\n        </CardHeader>\n      \n        <CardContent>\n          <div className=\" overflow-hidden shadow-sm sm:rounded-lg \">\n            {/* KPI Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6\">\n                <Card>\n                    <CardHeader  className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                        <CardTitle>Stock Total</CardTitle>\n                        <Box/>\n                    </CardHeader>\n                    <CardContent>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{produit.stocks.total}</p>\n                    </CardContent>\n                </Card>\n\n                <Card>\n                    <CardHeader  className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                        <CardTitle>Transferts Total</CardTitle>\n                        <CarFrontIcon/>\n                    </CardHeader>\n                    <CardContent>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{produit.transferts.total}</p>\n                    </CardContent>\n                </Card>\n\n                <Card>\n                    <CardHeader  className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                        <CardTitle>Alertes Total</CardTitle>\n                        <AlertCircle/>\n                    </CardHeader>\n                    <CardContent>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">{produit.alerts.total}</p>\n                    </CardContent>\n                </Card>\n             \n              \n            </div>\n\n            {/* Mouvements par mois */}\n            <Card>\n                <CardHeader>\n                    <CardTitle>\n                    Mouvements de stock par mois\n                    </CardTitle>\n                </CardHeader>\n                <CardContent>\n                        <div className=\"mt-6 h-80\">\n                            <ResponsiveContainer width=\"100%\" height=\"100%\">\n                            <AreaChart data={mouvementsData}>\n                                <CartesianGrid strokeDasharray=\"3 3\" />\n                                <XAxis dataKey=\"date\" />\n                                <YAxis />\n                                <Tooltip labelClassName='text-xs text-gray-500' itemStyle={{ backgroundColor: 'black' }} contentStyle={{ backgroundColor: 'black', color: 'white' }}\n                                formatter={(value) => [`${value} unités`, \n                                    { \n                                    entree: \"Entrée\", \n                                    sortie: \"Sortie\", \n                                    transfert: \"Transfert\", \n                                    ajustement: \"Ajustement\" \n                                    }[value as string]\n                                ]}\n                                />\n                                <Legend />\n                                <Area type=\"monotone\" dataKey=\"entree\" stroke=\"#10B981\" fill=\"#10B981\" />\n                                <Area type=\"monotone\" dataKey=\"sortie\" stroke=\"#EF4444\" fill=\"#EF4444\" />\n                                <Area type=\"monotone\" dataKey=\"transfert\" stroke=\"#3B82F6\" fill=\"#3B82F6\" />\n                                <Area type=\"monotone\" dataKey=\"ajustement\" stroke=\"#F59E0B\" fill=\"#F59E0B\" />\n                            </AreaChart>\n                            </ResponsiveContainer>\n                        </div>\n                </CardContent>\n            </Card>\n\n            {/* Stocks et Transferts */}\n            <Card className=\"mt-6\">\n                <CardHeader>\n                    <CardTitle>\n                        État des stocks\n                    </CardTitle>\n                </CardHeader>\n                <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n                    {/* Stocks */}\n                    <div className=\" p-6 rounded-lg shadow-lg\">\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">État des stocks</h3>\n                        <div className=\"mt-6 h-80\">\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\n                            <BarChart data={stocksData}>\n                            <CartesianGrid strokeDasharray=\"3 3\" />\n                            <XAxis dataKey=\"name\" />\n                            <YAxis />\n                            <Tooltip formatter={(value) => [`${value} unités`]} labelClassName='text-xs text-gray-500' itemStyle={{ backgroundColor: 'black', color: 'white' }} contentStyle={{ backgroundColor: 'black', color: 'white' }} />\n                            <Legend />\n                            <Bar dataKey=\"value\" name=\"Quantité\" radius={[4, 4, 0, 0]} />\n                            </BarChart>\n                        </ResponsiveContainer>\n                        </div>\n                    </div>\n\n                    {/* Transferts */}\n                    <div className=\" p-6 rounded-lg shadow-lg\">\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Statut des transferts</h3>\n                        <div className=\"mt-6 h-80\">\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\n                            <BarChart data={transfertsData}>\n                            <CartesianGrid strokeDasharray=\"3 3\" />\n                            <XAxis dataKey=\"name\" />\n                            <YAxis />\n                            <Tooltip formatter={(value) => [`${value} transferts`]} labelClassName='text-xs text-gray-500' itemStyle={{ backgroundColor: 'black', color: 'white' }} contentStyle={{ backgroundColor: 'black', color: 'white' }} />\n                            <Legend />\n                            <Bar dataKey=\"value\" name=\"Quantité\" radius={[4, 4, 0, 0]} />\n                            </BarChart>\n                        </ResponsiveContainer>\n                        </div>\n                    </div>\n                    </div>\n                        </CardContent>\n                    </Card>\n\n                    {/* Alertes */}\n                    <Card className=\"mt-6 rounded-lg shadow-lg\">\n                        <CardHeader>\n                            <CardTitle className=\"text-lg font-medium \">\n                            Alertes\n                            </CardTitle>\n                        </CardHeader>\n                    <div className=\"mt-6 h-80\">\n                        <ResponsiveContainer width=\"100%\" height=\"100%\">\n                        <BarChart data={alertsData}>\n                            <CartesianGrid strokeDasharray=\"3 3\" />\n                            <XAxis dataKey=\"name\" />\n                            <YAxis  />\n                            <Tooltip formatter={(value) => [`${value} alertes`]} labelClassName='text-xs text-gray-500' itemStyle={{ backgroundColor: 'black', color: 'white' }} contentStyle={{ backgroundColor: 'black', color: 'white' }}  />\n                            <Legend />\n                            <Bar dataKey=\"value\" name=\"Quantité\" radius={[4, 4, 0, 0]} />\n                        </BarChart>\n                        </ResponsiveContainer>\n                    </div>\n                    </Card>\n                </div>\n        </CardContent>\n      \n    </Card>\n  );\n}"],"names":["MedicamentStats","auth","produit","mouvementsParMois","acc","mouvement","date","mois","mouvementsData","stocksData","transfertsData","alertsData","Card","jsx","CardHeader","jsxs","CardTitle","CardContent","Box","CarFrontIcon","AlertCircle","ResponsiveContainer","AreaChart","CartesianGrid","XAxis","YAxis","Tooltip","value","Legend","Area","BarChart","Bar"],"mappings":"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"}