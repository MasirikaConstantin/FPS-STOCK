{"version":3,"file":"Index-BQThUg3-.js","sources":["../../../resources/js/pages/MedicalProduits/Index.tsx"],"sourcesContent":["import {\n    AlertDialog,\n    AlertDialogAction,\n    AlertDialogCancel,\n    AlertDialogContent,\n    AlertDialogDescription,\n    AlertDialogFooter,\n    AlertDialogHeader,\n    AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport AppLayout from '@/layouts/app-layout';\nimport { BreadcrumbItem, User } from '@/types';\nimport { App, PageProps } from '@/types/types';\nimport { Head, Link, router } from '@inertiajs/react';\nimport { Eye, MoreHorizontal, Pencil, Trash2, Snowflake } from 'lucide-react';\nimport { useState } from 'react';\nimport { toast } from 'sonner';\n\nexport default function Index({ produits, categories, fournisseurs, auth }: PageProps<{\n    produits: App.MedicalProduit[],\n    categories: App.Categorie[],\n    fournisseurs: App.Fournisseur[],\n    auth: User\n}>) {\n    const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n    const [produitToDelete, setProduitToDelete] = useState<App.MedicalProduit | null>(null);\n    const [openDropdownId, setOpenDropdownId] = useState<string | null>(null);\n\n    const breadcrumbs: BreadcrumbItem[] = [\n        {\n            title: 'Produits Médicaux',\n            href: '/medical-produits',\n        },\n    ];\n\n    const handleDelete = (produit: App.MedicalProduit) => {\n        setProduitToDelete(produit);\n        setDeleteDialogOpen(true);\n        setOpenDropdownId(null);\n    };\n\n    const confirmDelete = () => {\n        if (!produitToDelete) return;\n\n        router.delete(route('medical-produits.destroy', produitToDelete.ref), {\n            preserveScroll: true,\n            onSuccess: () => {\n                toast.success('Produit supprimé avec succès');\n                setDeleteDialogOpen(false);\n            },\n            onError: () => {\n                toast.error('Une erreur est survenue lors de la suppression');\n            },\n            onFinish: () => {\n                setOpenDropdownId(null);\n            },\n        });\n    };\n\n    const formatDate = (dateString: string | null) => {\n        if (!dateString) return '-';\n        return new Date(dateString).toLocaleDateString();\n    };\n\n    const getCategoryName = (id: number) => {\n        return categories.find(c => c.id === id)?.nom || 'Inconnue';\n    };\n\n    const getFournisseurName = (id: number | null) => {\n        if (!id) return '-';\n        return fournisseurs.find(f => f.id === id)?.nom || 'Inconnu';\n    };\n    const canCreateProduit = auth.user.permissions.some(p => p.action === 'create' && p.module === 'medical-produits');\n    const isAdminCentral = auth.user.role === 'admin_central';\n    const isAdmin = auth.user.role === 'admin';\n\n    return (\n        <AppLayout breadcrumbs={breadcrumbs}>\n            <Head title=\"Gestion des Produits Médicaux\" />\n\n            <div className=\"py-12\">\n                <div className=\"mx-auto max-w-7xl sm:px-6 lg:px-8\">\n                    <div className=\"overflow-hidden shadow-sm sm:rounded-lg\">\n                        <Card>\n                            <CardHeader className=\"flex flex-row items-center justify-between space-y-0\">\n                                <CardTitle className=\"text-2xl font-bold\">Gestion des Produits Médicaux</CardTitle>\n\n\n                                {canCreateProduit && (\n                                    <Button className=\"mb-3\">\n                                        <Link href={route('medical-produits.create')}>Ajouter un Produit</Link>\n                                    </Button>\n                                )}\n                                {isAdminCentral && (\n                                    <Button className=\"mb-3\">\n                                        <Link href={route('medical-produits.create')}>Ajouter un Produit</Link>\n                                    </Button>\n                                )}\n\n                            </CardHeader>\n                            <CardContent>\n                            <div className=\"p-6\">\n                                    \n                            <Table className=\"dark:text-gray-400cell w-full text-left text-sm text-gray-500 rtl:text-right\">\n                                <TableHeader>\n                                    <TableRow>\n                                        <TableHead>Nom</TableHead>\n                                        <TableHead>Catégorie</TableHead>\n                                        <TableHead>Unité</TableHead>\n                                        <TableHead>Fournisseur</TableHead>\n                                        <TableHead>Statut</TableHead>\n                                        <TableHead>Actions</TableHead>\n                                    </TableRow>\n                                </TableHeader>\n                                <TableBody>\n                                    {produits && produits.length > 0 ? (\n                                        produits.map((produit) => (\n                                            <TableRow key={produit.id}>\n\n                                                <TableCell className=\"font-medium text-black dark:text-white\">\n                                                    {produit.name.slice(0, 25)}\n                                                </TableCell>\n                                                <TableCell>\n                                                    {getCategoryName(produit.categorie_id).slice(0, 25)}...\n                                                </TableCell>\n                                               \n                                                <TableCell>\n                                                    {produit.unite}\n                                                </TableCell>\n                                                \n                                                <TableCell>\n                                                    {getFournisseurName(produit.fournisseur_id) || '-'}\n                                                </TableCell>\n                                                \n                                                <TableCell>\n                                                    <Badge variant={produit.seuil_min > 0 ? 'default' : 'secondary'}>\n                                                        {produit.seuil_min} min\n                                                    </Badge>\n                                                </TableCell>\n                                               \n                                                <TableCell>\n                                                    <DropdownMenu\n                                                        open={openDropdownId === produit.ref}\n                                                        onOpenChange={(open) => {\n                                                            setOpenDropdownId(open ? produit.ref : null);\n                                                        }}\n                                                    >\n                                                        <DropdownMenuTrigger asChild>\n                                                            <Button\n                                                                variant=\"ghost\"\n                                                                className=\"h-8 w-8 p-0\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                            >\n                                                                <MoreHorizontal className=\"h-4 w-4\" />\n                                                            </Button>\n                                                        </DropdownMenuTrigger>\n                                                        <DropdownMenuContent\n                                                            align=\"end\"\n                                                            onInteractOutside={() => setOpenDropdownId(null)}\n                                                        >\n                                                            <DropdownMenuItem asChild>\n                                                                <Link\n                                                                    href={route('medical-produits.show', produit.ref)}\n                                                                    className=\"flex items-center\"\n                                                                    onClick={() => setOpenDropdownId(null)}\n                                                                >\n                                                                    <Eye className=\"mr-2 h-4 w-4\" />\n                                                                    Voir\n                                                                </Link>\n                                                            </DropdownMenuItem>\n                                                            <DropdownMenuItem asChild>\n                                                                <Link\n                                                                    href={route('medical-produits.edit', produit.ref)}\n                                                                    className=\"flex items-center\"\n                                                                    onClick={() => setOpenDropdownId(null)}\n                                                                >\n                                                                    <Pencil className=\"mr-2 h-4 w-4\" />\n                                                                    Modifier\n                                                                </Link>\n                                                            </DropdownMenuItem>\n                                                            <DropdownMenuItem\n                                                                className=\"text-red-600 focus:bg-red-50 focus:text-red-600\"\n                                                                onClick={(e) => {\n                                                                    e.preventDefault();\n                                                                    handleDelete(produit);\n                                                                    setOpenDropdownId(null);\n                                                                }}\n                                                            >\n                                                                <Trash2 className=\"mr-2 h-4 w-4\" />\n                                                                Supprimer\n                                                            </DropdownMenuItem>\n                                                        </DropdownMenuContent>\n                                                    </DropdownMenu>\n                                                </TableCell>\n                                            </TableRow>\n                                        ))\n                                    ) : (\n                                        <TableRow>\n                                            <TableCell colSpan={11} className=\"py-4 text-center\">\n                                                <div className=\"text-gray-500\">Aucun produit médical trouvé.</div>\n                                                <Button asChild variant=\"link\" className=\"mt-2\">\n                                                    <Link href={route('medical-produits.create')}>Ajouter un produit</Link>\n                                                </Button>\n                                            </TableCell>\n                                        </TableRow>\n                                    )}\n                                </TableBody>\n                            </Table>\n                        </div>\n                            </CardContent>\n                        </Card>\n                               \n                    </div>\n                </div>\n            </div>\n\n            <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n                <AlertDialogContent>\n                    <AlertDialogHeader>\n                        <AlertDialogTitle>Êtes-vous sûr ?</AlertDialogTitle>\n                        <AlertDialogDescription>\n                            Cette action supprimera définitivement le produit \"{produitToDelete?.name}\" et ne pourra pas être annulée.\n                        </AlertDialogDescription>\n                    </AlertDialogHeader>\n                    <AlertDialogFooter>\n                        <AlertDialogCancel>Annuler</AlertDialogCancel>\n                        <AlertDialogAction onClick={confirmDelete}>Supprimer</AlertDialogAction>\n                    </AlertDialogFooter>\n                </AlertDialogContent>\n            </AlertDialog>\n        </AppLayout>\n    );\n}"],"names":["Index","produits","categories","fournisseurs","auth","deleteDialogOpen","setDeleteDialogOpen","useState","produitToDelete","setProduitToDelete","openDropdownId","setOpenDropdownId","breadcrumbs","handleDelete","produit","confirmDelete","router","toast","getCategoryName","id","_a","c","getFournisseurName","f","canCreateProduit","p","isAdminCentral","jsxs","AppLayout","jsx","Head","Card","CardHeader","CardTitle","Button","Link","CardContent","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","Badge","DropdownMenu","open","DropdownMenuTrigger","e","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","Eye","Pencil","Trash2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction"],"mappings":"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"}