{"version":3,"file":"Create-BWhDTaQU.js","sources":["../../../resources/js/pages/Admin/Permissions/Create.tsx"],"sourcesContent":["// resources/js/Pages/Admin/Permissions/Create.tsx\nimport { Head, useForm, router } from '@inertiajs/react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useState } from 'react';\nimport AppLayout from '@/layouts/app-layout';\nimport { BreadcrumbItem } from '@/types';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { toast } from 'sonner';\n\ninterface Props {\n    models: string[];\n    defaultPermissions: Record<string, string>;\n}\n\nexport default function CreatePermission({ models, defaultPermissions }: Props) {\n    const [selectedModel, setSelectedModel] = useState('');\n    const [selectedPermissions, setSelectedPermissions] = useState<string[]>([]);\n\n    const { data, setData, post, processing, errors } = useForm({\n        model: '',\n        permissions: [] as string[],\n    });\n\n    const handleSubmit = (e: React.FormEvent) => {\n        e.preventDefault();\n        post(route('admin.permissions.store'), {\n            onSuccess: () => {\n                toast.success('Permission créée avec succès');\n                router.visit(route('admin.permissions.index'));\n            },\n            onError: () => \n                toast.error('Une erreur est survenue lors de la création'),\n        });\n    };\n\n    const generatePermissions = () => {\n      if (!selectedModel) return [];\n      \n      // Convertit le modèle en format de table (minuscules avec 's')\n      const tableName = selectedModel.toLowerCase() + 's';\n      \n      return Object.entries(defaultPermissions).map(([action, label]) => ({\n          name: `${tableName}.${action}`,\n          description: `${label} ${tableName}`,\n          action,\n          module: tableName\n      }));\n  };\n    const breadcrumbs: BreadcrumbItem[] = [\n      {\n        title: 'Accueil',\n        href: route('dashboard'),\n      },\n      {\n        title: 'Gestion des Permissions',\n        href: route('admin.permissions.index'),\n      },\n      {\n        title: 'Créer des Permissions',\n        href: route('admin.permissions.create'),\n      },\n    ];\n\n    return (\n        <AppLayout breadcrumbs={breadcrumbs}>\n            <Head title=\"Créer des Permissions\" />\n            \n            <div className=\"p-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Nouvelles Permissions</CardTitle>\n                </CardHeader>\n                <CardContent>\n                <div className=\"\">\n                  <form onSubmit={handleSubmit} className=\"space-y-6\">\n                      <div className=\"space-y-2\">\n                          <Label htmlFor=\"model\">Modèle</Label>\n                          <Select \n                              onValueChange={(value) => {\n                                  setSelectedModel(value);\n                                  setData('model', value);\n                              }}\n                              value={selectedModel}\n                          >\n                              <SelectTrigger>\n                                  <SelectValue placeholder=\"Sélectionnez un modèle\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                  {(Array.isArray(models) ? models : Object.values(models)).map(model => (\n                                    <SelectItem key={model} value={model}>\n                                      {model}\n                                    </SelectItem>\n                                  ))}\n                              </SelectContent>\n                          </Select>\n                      </div>\n\n                      {selectedModel && (\n                          <div className=\"space-y-4\">\n                              <Label>Permissions à générer</Label>\n                              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                  {generatePermissions().map(permission => (\n                                      <div key={permission.name} className=\"flex items-center space-x-2 p-3 border rounded\">\n                                          <input\n                                              type=\"checkbox\"\n                                              id={`perm-${permission.name}`}\n                                              checked={selectedPermissions.includes(permission.name)}\n                                              onChange={(e) => {\n                                                  const newPermissions = e.target.checked\n                                                      ? [...selectedPermissions, permission.name]\n                                                      : selectedPermissions.filter(p => p !== permission.name);\n                                                  setSelectedPermissions(newPermissions);\n                                                  setData('permissions', newPermissions);\n                                              }}\n                                              className=\"rounded text-indigo-600\"\n                                          />\n                                          <label htmlFor={`perm-${permission.name}`} className=\"text-sm\">\n                                              <span className=\"font-medium block\">{permission.name}</span>\n                                              <span className=\"text-gray-500\">{permission.description}</span>\n                                          </label>\n                                      </div>\n                                  ))}\n                              </div>\n                          </div>\n                      )}\n\n                      <Button type=\"submit\" disabled={processing || !selectedModel || selectedPermissions.length === 0}>\n                          {processing ? 'Création...' : 'Créer les Permissions'}\n                      </Button>\n                  </form>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n        </AppLayout>\n    );\n}"],"names":["CreatePermission","models","defaultPermissions","selectedModel","setSelectedModel","useState","selectedPermissions","setSelectedPermissions","setData","post","processing","useForm","handleSubmit","e","toast","router","generatePermissions","tableName","action","label","breadcrumbs","jsxs","AppLayout","jsx","Head","Card","CardHeader","CardTitle","CardContent","Label","Select","value","SelectTrigger","SelectValue","SelectContent","model","SelectItem","permission","newPermissions","p","Button"],"mappings":"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"}