import{r as m,j as e,L as E,$ as i,S as M,t as f}from"./app-CSjzvEdl.js";import{T as P,A as B,a as _,b as I,c as O,d as F,e as H,f as G,g as L}from"./alert-dialog-CoufEpl9.js";import{B as l}from"./badge-BcNWtNC7.js";import{B as o}from"./button-DKtJZtgI.js";import{A as R,a as q,b as z,c as V,d as x}from"./app-layout-BI0sLpWU.js";import{T as $,a as Q,b as u,c as n,d as U,e as s}from"./table-Cjd2bJWp.js";import{C as X,a as J,b as K,c as W}from"./card-CbEGrNjZ.js";import{E as Y}from"./ellipsis-jZX-3Yh-.js";import{E as Z}from"./eye-YpocnOaT.js";import{P as ee}from"./pencil-otxOLBdj.js";import{P as re,a as se}from"./package-x-BYS-Q7cP.js";import{B as te}from"./box-D6fWdbaw.js";import{f as ne}from"./format-DoAzcPNu.js";import{f as ae}from"./fr-CLKhQ7g2.js";import"./app-DCR4OZ8t.js";import"./createLucideIcon-Bm1i9eVH.js";import"./index-CgyB2gb4.js";import"./utils-jAU0Cazi.js";import"./index-DtfqDP5q.js";import"./index-DtyIfu9z.js";import"./app-logo-icon-sN9k3MyY.js";import"./car-front-BKurbF1U.js";import"./package-C3gqZCnc.js";import"./en-US-DCG5IRVV.js";function Me({stocks:c,produits:g,hopitals:ie,auth:h}){const[v,d]=m.useState(!1),[p,C]=m.useState(null),[D,a]=m.useState(null),w=[{title:"Gestion des Stocks Central Central",href:"/stocks"}],N=r=>{C(r),d(!0),a(null)},b=()=>{p&&M.delete(route("central-stocks.destroy",p.ref),{preserveScroll:!0,onSuccess:()=>{f.success("Entrée de stock supprimée avec succès"),d(!1)},onError:()=>{f.error("Une erreur est survenue lors de la suppression")},onFinish:()=>{a(null)}})},j=r=>r?ne(new Date(r),"dd MMM yyyy",{locale:ae}):"-",A=r=>{var t;return((t=g.find(T=>T.id===r))==null?void 0:t.name)||"Inconnu"},y=r=>{switch(r){case"disponible":return e.jsxs(l,{variant:"default",children:[e.jsx(se,{className:"mr-1 h-3 w-3"})," Disponible"]});case"reservee":return e.jsxs(l,{variant:"secondary",children:[e.jsx(te,{className:"mr-1 h-3 w-3"})," Réservée"]});case"expirer":return e.jsxs(l,{variant:"destructive",children:[e.jsx(re,{className:"mr-1 h-3 w-3"})," Expiré"]});case"endommage":return e.jsx(l,{variant:"destructive",children:"Endommagé"});default:return e.jsx(l,{variant:"outline",children:"Inconnu"})}},S=h.user.permissions.some(r=>r.action==="create"&&r.module==="stocks"),k=h.user.role==="admin_central";return e.jsxs(R,{breadcrumbs:w,children:[e.jsx(E,{title:"Gestion des Stocks Central"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs(X,{children:[e.jsxs(J,{className:"flex justify-between items-center mb-6",children:[e.jsx(K,{className:"text-2xl font-bold",children:"Gestion des Stocks Central"}),S?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{asChild:!0,children:e.jsx(i,{href:route("central-stocks.create"),children:"Ajouter une entrée"})}),e.jsx(o,{variant:"outline",asChild:!0,children:e.jsx(i,{href:route("stock.entree.activite"),children:"Activité d'entrée"})})]}):k?e.jsx("div",{className:"text-red-500 text-sm font-bold w-1/2",children:e.jsx("p",{children:"Vous êtes connecté en tant qu'admin central, Mais ne pouvez pas créer des stocks, vous devez ajouter des permissions pour y accéder"})}):null]}),e.jsx(W,{children:e.jsxs($,{className:"dark:text-gray-400cell w-full text-left text-sm text-gray-500 rtl:text-right",children:[e.jsx(Q,{children:e.jsxs(u,{children:[e.jsx(n,{children:"Produit"}),e.jsx(n,{children:"Quantité"}),e.jsx(n,{children:"Numéro de lot"}),e.jsx(n,{children:"Date expiration"}),e.jsx(n,{children:"Prix unitaire"}),e.jsx(n,{children:"Date réception"}),e.jsx(n,{children:"Statut"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(U,{children:c&&c.length>0?c.map(r=>e.jsxs(u,{children:[e.jsx(s,{className:"font-medium text-black dark:text-white",children:A(r.medical_produit_id)}),e.jsx(s,{children:r.quantite}),e.jsx(s,{children:r.numero_lot||"-"}),e.jsx(s,{children:j(r.date_expiration)}),e.jsxs(s,{children:[r.prix_unitaire?parseFloat(r.prix_unitaire).toFixed(2):"0.00"," FC"]}),e.jsx(s,{children:j(r.received_date)}),e.jsx(s,{children:y(r.status)}),e.jsx(s,{children:e.jsxs(q,{open:D===r.ref,onOpenChange:t=>{a(t?r.ref:null)},children:[e.jsx(z,{asChild:!0,children:e.jsx(o,{variant:"ghost",className:"h-8 w-8 p-0",onClick:t=>t.stopPropagation(),children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsxs(V,{align:"end",onInteractOutside:()=>a(null),children:[e.jsx(x,{asChild:!0,children:e.jsxs(i,{href:route("central-stocks.show",r.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Voir"]})}),e.jsx(x,{asChild:!0,children:e.jsxs(i,{href:route("central-stocks.edit",r.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Modifier"]})}),e.jsxs(x,{className:"text-red-600 focus:bg-red-50 focus:text-red-600",onClick:t=>{t.preventDefault(),N(r),a(null)},children:[e.jsx(P,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},r.id)):e.jsx(u,{children:e.jsxs(s,{colSpan:9,className:"py-4 text-center",children:[e.jsx("div",{className:"text-gray-500",children:"Aucune entrée de stock trouvée."}),e.jsx(o,{asChild:!0,variant:"link",className:"mt-2",children:e.jsx(i,{href:route("central-stocks.create"),children:"Ajouter une entrée"})})]})})})]})})]})})})}),e.jsx(B,{open:v,onOpenChange:d,children:e.jsxs(_,{children:[e.jsxs(I,{children:[e.jsx(O,{children:"Êtes-vous sûr ?"}),e.jsx(F,{children:"Cette action supprimera définitivement cette entrée de stock et ne pourra pas être annulée."})]}),e.jsxs(H,{children:[e.jsx(G,{children:"Annuler"}),e.jsx(L,{onClick:b,children:"Supprimer"})]})]})})]})}export{Me as default};
//# sourceMappingURL=Index-C59k_7ZU.js.map
