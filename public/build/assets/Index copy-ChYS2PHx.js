import{r as u,j as e,L as _,$ as o,S as B,t as g}from"./app-DgZYpFq7.js";import{T as I,A as O,a as F,b as z,c as H,d as q,e as G,f as L,g as R}from"./alert-dialog-DNG5j5Bt.js";import{B as l}from"./badge-CwTEI7kw.js";import{B as x}from"./button-DzvBAvYb.js";import{A as V,a as $,b as Q,c as U,d as h}from"./app-layout-91MyU6xV.js";import{T as X,a as J,b as p,c as n,d as K,e as t}from"./table-FW4F-V4U.js";import{E as W}from"./ellipsis-BI_TzJKa.js";import{E as Y}from"./eye-C_ZkakFS.js";import{P as Z}from"./pencil-DpzAsbso.js";import{P as ee,a as se}from"./package-x-B1Uf0E2Z.js";import{B as re}from"./box-DIzyKyB3.js";import{f as te}from"./format-DoAzcPNu.js";import{f as ne}from"./fr-CLKhQ7g2.js";import"./app-nklVn4u_.js";import"./createLucideIcon-Bp4--aub.js";import"./index-C9XCcCFj.js";import"./utils-jAU0Cazi.js";import"./index-DOjrUmdc.js";import"./index-DUIdKc2i.js";import"./app-logo-icon-Dkusirb4.js";import"./car-front-DHnhNWiQ.js";import"./package-CUTUJuVR.js";import"./en-US-DCG5IRVV.js";function Se({stocks:c,produits:v,hopitals:D,auth:i}){const[N,d]=u.useState(!1),[j,w]=u.useState(null),[C,a]=u.useState(null),b=i.user.permissions.some(s=>s.action==="create"&&s.module==="stocks");i.user.permissions.some(s=>s.action==="update"&&s.module==="stocks"),i.user.permissions.some(s=>s.action==="delete"&&s.module==="stocks");const A=i.user.role==="admin_central",k=i.user.role==="admin",y=[{title:"Gestion des Stocks",href:"/stocks"}],S=s=>{w(s),d(!0),a(null)},T=()=>{j&&B.delete(route("stocks.destroy",j.ref),{preserveScroll:!0,onSuccess:()=>{g.success("Entrée de stock supprimée avec succès"),d(!1)},onError:()=>{g.error("Une erreur est survenue lors de la suppression")},onFinish:()=>{a(null)}})},f=s=>s?te(new Date(s),"dd MMM yyyy",{locale:ne}):"-",E=s=>{var r;return((r=v.find(m=>m.id===s))==null?void 0:r.name)||"Inconnu"},M=s=>{var r;return s?((r=D.find(m=>m.id===s))==null?void 0:r.nom)||"Inconnu":"Stock central"},P=s=>{switch(s){case"disponible":return e.jsxs(l,{variant:"default",children:[e.jsx(se,{className:"mr-1 h-3 w-3"})," Disponible"]});case"reservee":return e.jsxs(l,{variant:"secondary",children:[e.jsx(re,{className:"mr-1 h-3 w-3"})," Réservée"]});case"expirer":return e.jsxs(l,{variant:"destructive",children:[e.jsx(ee,{className:"mr-1 h-3 w-3"})," Expiré"]});case"endommage":return e.jsx(l,{variant:"destructive",children:"Endommagé"});default:return e.jsx(l,{variant:"outline",children:"Inconnu"})}};return e.jsxs(V,{breadcrumbs:y,children:[e.jsx(_,{title:"Gestion des Stocks"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gestion des Stocks"}),b?e.jsx(x,{asChild:!0,children:e.jsx(o,{href:route("stocks.create"),children:"Ajouter une entrée"})}):A?e.jsx("div",{className:"text-red-500 text-sm font-bold w-1/2",children:e.jsx("p",{children:"Vous êtes connecté en tant qu'admin central, Mais ne pouvez pas créer des stocks, vous devez ajouter des permissions pour y accéder"})}):k?e.jsx("div",{className:"text-red-500 text-sm font-bold w-1/2",children:e.jsx("p",{children:"Vous êtes connecté en tant qu'admin, Mais ne pouvez pas créer des stocks, vous devez ajouter des permissions pour y accéder"})}):null]}),e.jsxs(X,{className:"dark:text-gray-400cell w-full text-left text-sm text-gray-500 rtl:text-right",children:[e.jsx(J,{children:e.jsxs(p,{children:[e.jsx(n,{children:"Produit"}),e.jsx(n,{children:"Quantité"}),e.jsx(n,{children:"Numéro de lot"}),e.jsx(n,{children:"Date expiration"}),e.jsx(n,{children:"Prix unitaire"}),e.jsx(n,{children:"Date réception"}),e.jsx(n,{children:"Emplacement"}),e.jsx(n,{children:"Statut"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(K,{children:c&&c.length>0?c.map(s=>e.jsxs(p,{children:[e.jsx(t,{className:"font-medium text-black dark:text-white",children:E(s.medical_produit_id)}),e.jsx(t,{children:s.quantite}),e.jsx(t,{children:s.numero_lot||"-"}),e.jsx(t,{children:f(s.date_expiration)}),e.jsxs(t,{children:[s.prix_unitaire?parseFloat(s.prix_unitaire).toFixed(2):"0.00"," FC"]}),e.jsx(t,{children:f(s.received_date)}),e.jsx(t,{children:M(s.hopital_id)}),e.jsx(t,{children:P(s.status)}),e.jsx(t,{children:e.jsxs($,{open:C===s.ref,onOpenChange:r=>{a(r?s.ref:null)},children:[e.jsx(Q,{asChild:!0,children:e.jsx(x,{variant:"ghost",className:"h-8 w-8 p-0",onClick:r=>r.stopPropagation(),children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsxs(U,{align:"end",onInteractOutside:()=>a(null),children:[e.jsx(h,{asChild:!0,children:e.jsxs(o,{href:route("stocks.show",s.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Voir"]})}),e.jsx(h,{asChild:!0,children:e.jsxs(o,{href:route("stocks.edit",s.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Modifier"]})}),e.jsxs(h,{className:"text-red-600 focus:bg-red-50 focus:text-red-600",onClick:r=>{r.preventDefault(),S(s),a(null)},children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},s.id)):e.jsx(p,{children:e.jsxs(t,{colSpan:9,className:"py-4 text-center",children:[e.jsx("div",{className:"text-gray-500",children:"Aucune entrée de stock trouvée."}),e.jsx(x,{asChild:!0,variant:"link",className:"mt-2",children:e.jsx(o,{href:route("stocks.create"),children:"Ajouter une entrée"})})]})})})]})]})})})}),e.jsx(O,{open:N,onOpenChange:d,children:e.jsxs(F,{children:[e.jsxs(z,{children:[e.jsx(H,{children:"Êtes-vous sûr ?"}),e.jsx(q,{children:"Cette action supprimera définitivement cette entrée de stock et ne pourra pas être annulée."})]}),e.jsxs(G,{children:[e.jsx(L,{children:"Annuler"}),e.jsx(R,{onClick:T,children:"Supprimer"})]})]})})]})}export{Se as default};
//# sourceMappingURL=Index copy-ChYS2PHx.js.map
