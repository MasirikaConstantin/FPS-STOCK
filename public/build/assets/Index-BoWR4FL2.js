import{r as m,j as e,L as M,$ as o,S as P,t as f}from"./app-CfIQfryc.js";import{T as B,A as _,a as I,b as O,c as F,d as z,e as H,f as q,g as G}from"./alert-dialog-B252CZ34.js";import{B as l}from"./badge-CEGVyFq6.js";import{B as u}from"./button-By8FOct-.js";import{A as L,a as R,b as V,c as $,d as x}from"./app-layout-DBCqPTBR.js";import{T as Q,a as U,b as p,c as n,d as X,e as r}from"./table-BeH2ah0y.js";import{C as J,a as K,b as W,c as Y}from"./card-DdvJbsWn.js";import{E as Z}from"./ellipsis-4FxrYdR1.js";import{E as ee}from"./eye-skH557t9.js";import{P as se}from"./pencil-BG30dTx7.js";import{P as re,a as te}from"./package-x-Dj6J7_KY.js";import{B as ne}from"./box-DHVz2B_N.js";import{f as ae}from"./format-DoAzcPNu.js";import{f as ie}from"./fr-CLKhQ7g2.js";import"./app-XAPMnnx3.js";import"./createLucideIcon-DjaE45rK.js";import"./index-F55flZwV.js";import"./utils-jAU0Cazi.js";import"./index-BSyT1Gdz.js";import"./index-B8Z1OlCE.js";import"./app-logo-icon-Cf6SMoi-.js";import"./car-front-B2ibBUtT.js";import"./package-CAWIZc5k.js";import"./en-US-DCG5IRVV.js";function Pe({stocks:c,produits:v,hopitals:le,auth:i}){const[g,d]=m.useState(!1),[h,w]=m.useState(null),[D,a]=m.useState(null),C=i.user.permissions.some(s=>s.action==="create"&&s.module==="stocks");i.user.permissions.some(s=>s.action==="update"&&s.module==="stocks"),i.user.permissions.some(s=>s.action==="delete"&&s.module==="stocks");const N=i.user.role==="admin_central",b=i.user.role==="admin",y=[{title:"Gestion des Stocks",href:"/stocks"}],A=s=>{w(s),d(!0),a(null)},k=()=>{h&&P.delete(route("stocks.destroy",h.ref),{preserveScroll:!0,onSuccess:()=>{f.success("Entrée de stock supprimée avec succès"),d(!1)},onError:()=>{f.error("Une erreur est survenue lors de la suppression")},onFinish:()=>{a(null)}})},j=s=>s?ae(new Date(s),"dd MMM yyyy",{locale:ie}):"-",S=s=>{var t;return((t=v.find(E=>E.id===s))==null?void 0:t.name)||"Inconnu"},T=s=>{switch(s){case"disponible":return e.jsxs(l,{variant:"default",children:[e.jsx(te,{className:"mr-1 h-3 w-3"})," Disponible"]});case"reservee":return e.jsxs(l,{variant:"secondary",children:[e.jsx(ne,{className:"mr-1 h-3 w-3"})," Réservée"]});case"expirer":return e.jsxs(l,{variant:"destructive",children:[e.jsx(re,{className:"mr-1 h-3 w-3"})," Expiré"]});case"endommage":return e.jsx(l,{variant:"destructive",children:"Endommagé"});default:return e.jsx(l,{variant:"outline",children:"Inconnu"})}};return e.jsxs(L,{breadcrumbs:y,children:[e.jsx(M,{title:"Gestion des Stocks"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsxs(J,{children:[e.jsxs(K,{className:"flex flex-row items-center justify-between space-y-0",children:[e.jsx(W,{className:"text-2xl font-bold",children:"Gestion des Stocks"}),C?e.jsx(u,{asChild:!0,children:e.jsx(o,{href:route("stocks.create"),children:"Ajouter une entrée"})}):N?e.jsx("div",{className:"text-red-500 text-sm font-bold w-1/2",children:e.jsx("p",{children:"Vous êtes connecté en tant qu'admin central, Mais ne pouvez pas créer des stocks, vous devez ajouter des permissions pour y accéder"})}):b?e.jsx("div",{className:"text-red-500 text-sm font-bold w-1/2",children:e.jsx("p",{children:"Vous êtes connecté en tant qu'admin, Mais ne pouvez pas créer des stocks, vous devez ajouter des permissions pour y accéder"})}):null]}),e.jsx(Y,{children:e.jsx("div",{className:"overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6"}),e.jsxs(Q,{className:"dark:text-gray-400cell w-full text-left text-sm text-gray-500 rtl:text-right",children:[e.jsx(U,{children:e.jsxs(p,{children:[e.jsx(n,{children:"Produit"}),e.jsx(n,{children:"Quantité"}),e.jsx(n,{children:"Numéro de lot"}),e.jsx(n,{children:"Date expiration"}),e.jsx(n,{children:"Prix unitaire"}),e.jsx(n,{children:"Date réception"}),e.jsx(n,{children:"Statut"}),e.jsx(n,{children:"Actions"})]})}),e.jsx(X,{children:c&&c.length>0?c.map(s=>e.jsxs(p,{children:[e.jsx(r,{className:"font-medium text-black dark:text-white",children:S(s.medical_produit_id)}),e.jsx(r,{children:s.quantite}),e.jsx(r,{children:s.numero_lot||"-"}),e.jsx(r,{children:j(s.date_expiration)}),e.jsxs(r,{children:[s.prix_unitaire?parseFloat(s.prix_unitaire).toFixed(2):"0.00"," FC"]}),e.jsx(r,{children:j(s.received_date)}),e.jsx(r,{children:T(s.status)}),e.jsx(r,{children:e.jsxs(R,{open:D===s.ref,onOpenChange:t=>{a(t?s.ref:null)},children:[e.jsx(V,{asChild:!0,children:e.jsx(u,{variant:"ghost",className:"h-8 w-8 p-0",onClick:t=>t.stopPropagation(),children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs($,{align:"end",onInteractOutside:()=>a(null),children:[e.jsx(x,{asChild:!0,children:e.jsxs(o,{href:route("stocks.show",s.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Voir"]})}),e.jsx(x,{asChild:!0,children:e.jsxs(o,{href:route("stocks.edit",s.ref),className:"flex items-center",onClick:()=>a(null),children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Modifier"]})}),e.jsxs(x,{className:"text-red-600 focus:bg-red-50 focus:text-red-600",onClick:t=>{t.preventDefault(),A(s),a(null)},children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},s.id)):e.jsx(p,{children:e.jsxs(r,{colSpan:9,className:"py-4 text-center",children:[e.jsx("div",{className:"text-gray-500",children:"Aucune entrée de stock trouvée."}),e.jsx(u,{asChild:!0,variant:"link",className:"mt-2",children:e.jsx(o,{href:route("stocks.create"),children:"Ajouter une entrée"})})]})})})]})]})})})]})})}),e.jsx(_,{open:g,onOpenChange:d,children:e.jsxs(I,{children:[e.jsxs(O,{children:[e.jsx(F,{children:"Êtes-vous sûr ?"}),e.jsx(z,{children:"Cette action supprimera définitivement cette entrée de stock et ne pourra pas être annulée."})]}),e.jsxs(H,{children:[e.jsx(q,{children:"Annuler"}),e.jsx(G,{onClick:k,children:"Supprimer"})]})]})})]})}export{Pe as default};
//# sourceMappingURL=Index-BoWR4FL2.js.map
