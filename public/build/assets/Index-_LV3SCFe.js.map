{"version":3,"file":"Index-_LV3SCFe.js","sources":["../../../resources/js/pages/Categories/Index.tsx"],"sourcesContent":["import {\n    AlertDialog,\n    AlertDialogAction,\n    AlertDialogCancel,\n    AlertDialogContent,\n    AlertDialogDescription,\n    AlertDialogFooter,\n    AlertDialogHeader,\n    AlertDialogTitle,\n} from '@/components/ui/alert-dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport AppLayout from '@/layouts/app-layout';\nimport { BreadcrumbItem } from '@/types';\nimport { App, PageProps } from '@/types/types';\nimport { Head, Link, router } from '@inertiajs/react';\nimport { Eye, MoreHorizontal, Pencil, Trash2 } from 'lucide-react';\nimport { useState } from 'react';\nimport { toast } from 'sonner';\n\nexport default function Index({  categories }: PageProps<{ categories: App.Category[] }>) {\n    const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);\n    const [categoryToDelete, setCategoryToDelete] = useState<App.Category | null>(null);\n    const [openDropdownId, setOpenDropdownId] = useState<number | null>(null);\n\n    const breadcrumbs: BreadcrumbItem[] = [\n        {\n            title: 'Catégories',\n            href: '/categories',\n        },\n    ];\n\n    const handleDelete = (category: App.Category) => {\n        setCategoryToDelete(category);\n        setDeleteDialogOpen(true);\n        setOpenDropdownId(null); // Ferme le dropdown immédiatement\n    };\n\n    const confirmDelete = () => {\n        if (!categoryToDelete) return;\n\n        router.delete(route('categories.destroy', categoryToDelete.id), {\n            preserveScroll: true,\n            onSuccess: () => {\n                toast.success('Catégorie supprimée avec succès');\n                setDeleteDialogOpen(false);\n            },\n            onError: () => {\n                toast.error('Une erreur est survenue lors de la suppression');\n            },\n            onFinish: () => {\n                setOpenDropdownId(null); // S'assure que le dropdown est fermé\n            },\n        });\n    };\n\n    return (\n        <AppLayout breadcrumbs={breadcrumbs}>\n            <Head title=\"Gestion des Catégories\" />\n\n            <div className=\"py-12\">\n                <div className=\"mx-auto max-w-7xl sm:px-6 lg:px-8\">\n                    <div className=\"overflow-hidden shadow-sm sm:rounded-lg\">\n                        <Card>\n                            <CardHeader className=\"flex flex-row items-center justify-between space-y-0\">\n                            <CardTitle className=\"text-xl font-semibold\">Gestion des Catégories</CardTitle>\n                            <Button className=\"mb-3\">\n                                <Link href={route('categories.create')}>Créer une Catégorie</Link>\n                            </Button>\n                            </CardHeader>\n                            <CardContent>\n                            <div className=\"p-6\">\n                            \n                            <Table className=\"dark:text-gray-400cell w-full text-left text-sm text-gray-500 rtl:text-right\">\n                                <TableHeader>\n                                    <TableRow>\n                                        <TableHead>Nom</TableHead>\n                                        <TableHead>Description</TableHead>\n                                        <TableHead>Statut</TableHead>\n                                        <TableHead>Créé par</TableHead>\n                                        <TableHead>Date de création</TableHead>\n                                        <TableHead>Actions</TableHead>\n                                    </TableRow>\n                                </TableHeader>\n                                <TableBody>\n                                    {categories && categories.length > 0 ? (\n                                        categories.map((category) => (\n                                            <TableRow key={category.id}>\n                                                <TableCell className=\"font-medidum text-black dark:text-white\">{category.nom}</TableCell>\n                                                <TableCell>{category.description?.slice(0, 30) || '-'}\n                                                    \n                                                </TableCell>\n                                                <TableCell>\n                                                    <Badge variant={category.is_active ? 'default' : 'destructive'}>\n                                                        {category.is_active ? 'Actif' : 'Inactif'}\n                                                    </Badge>\n                                                </TableCell>\n                                                <TableCell>{category.creator?.name || 'Système'}</TableCell>\n                                                <TableCell>{new Date(category.created_at).toLocaleDateString()}</TableCell>\n                                                <TableCell>\n                                                    <DropdownMenu\n                                                        open={openDropdownId === category.id}\n                                                        onOpenChange={(open) => {\n                                                            // Fermer les autres dropdowns quand on en ouvre un nouveau\n                                                            setOpenDropdownId(open ? category.id : null);\n                                                        }}\n                                                    >\n                                                        <DropdownMenuTrigger asChild>\n                                                            <Button\n                                                                variant=\"ghost\"\n                                                                className=\"h-8 w-8 p-0\"\n                                                                onClick={(e) => e.stopPropagation()} // Empêche la propagation\n                                                            >\n                                                                <MoreHorizontal className=\"h-4 w-4\" />\n                                                            </Button>\n                                                        </DropdownMenuTrigger>\n                                                        <DropdownMenuContent\n                                                            align=\"end\"\n                                                            onInteractOutside={() => setOpenDropdownId(null)} // Ferme quand on clique ailleurs\n                                                        >\n                                                            <DropdownMenuItem asChild>\n                                                                <Link\n                                                                    href={route('categories.show', category.ref)}\n                                                                    className=\"flex items-center\"\n                                                                    onClick={() => setOpenDropdownId(null)} // Ferme après clic\n                                                                >\n                                                                    <Eye className=\"mr-2 h-4 w-4\" />\n                                                                    Voir\n                                                                </Link>\n                                                            </DropdownMenuItem>\n                                                            <DropdownMenuItem asChild>\n                                                                <Link\n                                                                    href={route('categories.edit', category.ref)}\n                                                                    className=\"flex items-center\"\n                                                                    onClick={() => setOpenDropdownId(null)} // Ferme après clic\n                                                                >\n                                                                    <Pencil className=\"mr-2 h-4 w-4\" />\n                                                                    Modifier\n                                                                </Link>\n                                                            </DropdownMenuItem>\n                                                            <DropdownMenuItem\n                                                                className=\"text-red-600 focus:bg-red-50 focus:text-red-600\"\n                                                                onClick={(e) => {\n                                                                    e.preventDefault();\n                                                                    handleDelete(category);\n                                                                    setOpenDropdownId(null); // Ferme immédiatement\n                                                                }}\n                                                            >\n                                                                <Trash2 className=\"mr-2 h-4 w-4\" />\n                                                                Supprimer\n                                                            </DropdownMenuItem>\n                                                        </DropdownMenuContent>\n                                                    </DropdownMenu>\n                                                </TableCell>\n                                            </TableRow>\n                                        ))\n                                    ) : (\n                                        <TableRow>\n                                            <TableCell colSpan={6} className=\"py-4 text-center\">\n                                                <div className=\"text-gray-500\">Aucune catégorie trouvée.</div>\n                                                <Button asChild variant=\"link\" className=\"mt-2\">\n                                                    <Link href={route('categories.create')}>Créer une catégorie</Link>\n                                                </Button>\n                                            </TableCell>\n                                        </TableRow>\n                                    )}\n                                </TableBody>\n                            </Table>\n                        </div>\n                            </CardContent>\n                        </Card>\n                        \n                    </div>\n                </div>\n            </div>\n\n            <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>\n                <AlertDialogContent>\n                    <AlertDialogHeader>\n                        <AlertDialogTitle>Êtes-vous sûr ?</AlertDialogTitle>\n                        <AlertDialogDescription>\n                            Cette action supprimera définitivement la catégorie \"{categoryToDelete?.nom}\" et ne pourra pas être annulée.\n                        </AlertDialogDescription>\n                    </AlertDialogHeader>\n                    <AlertDialogFooter>\n                        <AlertDialogCancel>Annuler</AlertDialogCancel>\n                        <AlertDialogAction onClick={confirmDelete}>Supprimer</AlertDialogAction>\n                    </AlertDialogFooter>\n                </AlertDialogContent>\n            </AlertDialog>\n        </AppLayout>\n    );\n}\n"],"names":["Index","categories","deleteDialogOpen","setDeleteDialogOpen","useState","categoryToDelete","setCategoryToDelete","openDropdownId","setOpenDropdownId","breadcrumbs","handleDelete","category","confirmDelete","router","toast","jsxs","AppLayout","jsx","Head","Card","CardHeader","CardTitle","Button","Link","CardContent","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","_a","Badge","_b","DropdownMenu","open","DropdownMenuTrigger","e","MoreHorizontal","DropdownMenuContent","DropdownMenuItem","Eye","Pencil","Trash2","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction"],"mappings":"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"}